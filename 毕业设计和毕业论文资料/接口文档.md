# 毕业设计接口文档

**baseURL：127.0.0.1**:8000



### 一、用户接口

#### 1、注册接口—管理员

**请求方式**：POST

**接口地址 :** `/user/register`

**参数** ：`username`: 不能为空

​			`password`：不能为空

**调用例子 :** `/user/register`

**成功返回值**：`{ "status": 1, "message": "注册成功~"}`

#### 2、登录接口—管理员

**请求方式**：POST

**接口地址 :** `/user/login`

**参数** ：`username`: 不能为空

​			`password`：不能为空

**调用例子 :** `/user/login`

**成功返回值**：`{
    "status": 1,
    "id": 1,
    "username": "xwl01",
    "token": "......",
    "menu": [
       	 {
       	     "id": 1,
       	     "menuURL": "/user",
       	     "type": 1
       	 },
     	   ......
  	  ]
	}`

#### 3、单个用户(登录\禁止)状态接口—管理员

**请求方式**：GET

**接口地址 :** `/user/updateUserLoginStatus`

**参数** ：`user_id`: 不能为空

​			`loginStatus`：值为0\1

**调用例子 :** `/user/updateUserLoginStatus`

**成功返回值**：`{

​							   status: 1,

​							   message: "单个用户登录状态修改成功~",

  						};`

#### 4、同类型状态其中之一修改接口—管理员

**请求方式**：GET

**接口地址 :** `/user/updateAllStatus`

**参数** ：`fieldName`: ![image-20221203222742431](C:\Users\86134\AppData\Roaming\Typora\typora-user-images\image-20221203222742431.png)

​			`status`：值为0\1

**调用例子 :** `/user/updateAllStatus`

**成功返回值**：`{	

​							   status: 1,

​							   message: "用户状态其中之一修改成功~",

​						  };`



### 二、角色接口

#### 1、添加角色接口—管理员

**请求方式**：GET

**接口地址 :** `/roleANDmenu/createRole`

**参数** ：`role_id`: 不能为空

​			`menu_idAarr`：不能为空，例如："1,2,3",代表三个权限

**调用例子 :** `/roleANDmenu/createRole`

**成功返回值**：`{
  				 "status": 1,
   				 "message": "角色创建成功~"
			}`

#### 2、指定角色修改权限接口—管理员

**请求方式**：GET

**接口地址 :** `/roleANDmenu/updateRole`

**参数** ：`role_id`: 不能为空

​			`menu_idAarr`：不能为空，例如："1,2,3",代表三个权限

**调用例子 :** `/roleANDmenu/updateRole`

**成功返回值**：`{
  				 "status": 1,
   				 "message": "权限修改成功~"
			}`

#### 3、查询所有角色（附带权限信息）接口—管理员

**请求方式**：GET

**接口地址 :** `/roleANDmenu/getRole`

**调用例子 :** `/roleANDmenu/getRole`

**成功返回值**：`{
  				 ...
   				 "power": [{},...]
			}`

#### 4、指定删除角色接口—管理员

**请求方式**：GET

**接口地址 :** `/roleANDmenu/deleteRole`

**参数** ：`role_id`: 不能为空

**调用例子 :** `/roleANDmenu/deleteRole`

**成功返回值**：`{
  				 ...
   				 "power": [{},...]
			}`



### 三、文件接口

#### 1、获取已上传文件切片名接口

**请求方式**：GET

**接口地址 :** `/file/getFileSlice`

**验证请求**：携带Bearer Token

**参数** ：hash，suffix	

**调用例子 :** `axios.get(
          "baseURL/file/getFileSlice",
          {
            params: {
              hash,
            },
          }
        )	`

**成功返回值**：`同一文件切片hash名数组：[......]`

#### 2、文件切片上传接口

**请求方式**：POST

**接口地址 :** `/file/uploadFileSlice`

**验证请求**：携带Bearer Token

**文件类型**：ipeg，png，mp4

**参数** ：formData切片数据		

**调用例子 :** `/file/uploadFileSlice`

**成功返回值**：`{
      			status: 1,
     			message: "上传成功~",
     			user: ...,
   			 }`

#### 3、文件切片合并接口

**请求方式**：GET

**接口地址 :** `/file/mergeFile`

**验证请求**：携带Bearer Token

**参数** ：hash,（文件hash值）

​			 fileName，（文件名）	

​             suffix,（文件后缀名）
​             type,（文件类型）
​             len: index（切片数量）		

**调用例子 :** `axios.get("http://127.0.0.1:8000/file/mergeFile", {
              params: {
                hash,
                suffix,
                type,
                len: index,
              },
            })`

**成功返回值**：`{
      			status: 1,
    			message: "合并成功~",
    			file: res,
     			user: ctx.user,
   			 }`

#### 4、获取全部文件信息

说明：根据user_id和type获取

**请求方式**：GET

**接口地址 :** `/file/getFileInfo`

**验证请求**：携带Bearer Token

**参数** ：type，（video、image）

​			limit：返回条数，默认为12

​			offset：偏移量，默认为0	

**调用例子 :** `/file/getFileInfo`

**成功返回值**：`多个文件信息对象数组`

#### 5、获取文件内容

**请求方式**：GET	

**接口地址 :** `/file/getFile`

**验证请求**：携带Bearer Token

**参数** ：file_id

**调用例子 :** `/file/getFile`

**成功返回值**：`返回文件内容在浏览器展示`

#### 6、下载文件

**请求方式**：GET	

**接口地址 :** `/file/downloadFile`

**验证请求**：携带Bearer Token

**参数** ：file_id

**调用例子 :** `/file/downloadFile`

**成功返回值**：`返回文件内容在浏览器展示`



### 四、token验证

#### 1、注册接口

**请求方式**：GET

**接口地址 :** `/auth/verifyToken`

**验证请求**：携带Bearer Token

**调用例子 :** `/auth/verifyToken`

**成功返回值**：`{
    			"id": 1,
    			"username": "xwl01",
    			"role_id": 2,
    			"token": "......"
			}`
